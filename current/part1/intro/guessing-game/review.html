<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js lfe-pdp">

<head>
    <!-- Book generated using mdBook -->
    <meta charset="UTF-8">
    <title>Code Review - LFE MACHINE MANUAL</title>
    
    


    <!-- Custom HTML head -->
    


    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta name="description" content="The Manual for the Machine that is LFE/OTP">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#ffffff" />

    <link rel="icon" href="../../../favicon.svg">
    <link rel="shortcut icon" href="../../../favicon.png">
    <link rel="stylesheet" href="../../../css/variables.css">
    <link rel="stylesheet" href="../../../css/general.css">
    <link rel="stylesheet" href="../../../css/chrome.css">
    <link rel="stylesheet" href="../../../css/print.css" media="print">

    <!-- Fonts -->
    <link rel="stylesheet" href="../../../FontAwesome/css/font-awesome.css">
    
    <link rel="stylesheet" href="../../../fonts/fonts.css">
    

    <!-- Highlight.js Stylesheets -->
    <link rel="stylesheet" href="../../../highlight.css">
    <link rel="stylesheet" href="../../../tomorrow-night.css">
    <link rel="stylesheet" href="../../../ayu-highlight.css">

    <!-- Custom theme stylesheets -->
    
    <link rel="stylesheet" href="../../../css/custom.css">
    

    
</head>

<body>
    <!-- Provide site root to javascript -->
    <script type="text/javascript">
        var path_to_root = "../../../";
        var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "lfe-pdp" : "lfe-pdp";
    </script>

    <!-- Work around some values being stored in localStorage wrapped in quotes -->
    <script type="text/javascript">
        try {
            var theme = localStorage.getItem('mdbook-theme');
            var sidebar = localStorage.getItem('mdbook-sidebar');

            if (theme.startsWith('"') && theme.endsWith('"')) {
                localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
            }

            if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
            }
        } catch (e) { }
    </script>

    <!-- Set the theme before any content is loaded, prevents flash -->
    <script type="text/javascript">
        var theme;
        try { theme = localStorage.getItem('mdbook-theme'); } catch (e) { }
        if (theme === null || theme === undefined) { theme = default_theme; }
        var html = document.querySelector('html');
        html.classList.remove('no-js')
        html.classList.remove('lfe-pdp')
        html.classList.add(theme);
        html.classList.add('js');
    </script>

    <!-- Hide / unhide sidebar before it is displayed -->
    <script type="text/javascript">
        var html = document.querySelector('html');
        var sidebar = 'hidden';
        if (document.body.clientWidth >= 1080) {
            try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch (e) { }
            sidebar = sidebar || 'visible';
        }
        html.classList.remove('sidebar-visible');
        html.classList.add("sidebar-" + sidebar);
    </script>

    <nav id="sidebar" class="sidebar" aria-label="Table of contents">
        <div class="sidebar-scrollbox">
            <ol class="chapter"><li class="chapter-item affix "><a href="../../../index.html">LFE MACHINE MANUAL</a></li><li class="chapter-item affix "><a href="../../../fm/title-page.html">Title Page</a></li><li class="chapter-item affix "><a href="../../../fm/copyright.html">Copyright</a></li><li class="spacer"></li><li class="chapter-item affix "><a href="../../../preface/index.html">Preface</a></li><li class="chapter-item affix "><a href="../../../preface/about-cover.html">About the Cover</a></li><li class="chapter-item affix "><a href="../../../preface/dedication.html">Dedication</a></li><li class="chapter-item affix "><a href="../../../preface/forward.html">Forward</a></li><li class="chapter-item affix "><a href="../../../preface/acknowledgments.html">Acknowledgments</a></li><li class="spacer"></li><li class="chapter-item expanded "><a href="../../../part1/index.html"><strong aria-hidden="true">1.</strong> Part I - Getting Started</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../part1/intro/index.html"><strong aria-hidden="true">1.1.</strong> Introduction</a></li><li class="chapter-item "><a href="../../../part1/intro/prereq.html"><strong aria-hidden="true">1.2.</strong> Prerequisites</a></li><li class="chapter-item "><a href="../../../part1/intro/conventions.html"><strong aria-hidden="true">1.3.</strong> Conventions</a></li><li class="chapter-item "><a href="../../../part1/intro/setup.html"><strong aria-hidden="true">1.4.</strong> Development Setup</a></li><li class="chapter-item "><a href="../../../part1/intro/hw/index.html"><strong aria-hidden="true">1.5.</strong> 'Hello, World!'</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../part1/intro/hw/repl.html"><strong aria-hidden="true">1.5.1.</strong> Classic, REPL</a></li><li class="chapter-item "><a href="../../../part1/intro/hw/main.html"><strong aria-hidden="true">1.5.2.</strong> Classic, main</a></li><li class="chapter-item "><a href="../../../part1/intro/hw/otp.html"><strong aria-hidden="true">1.5.3.</strong> LFE/OTP</a></li></ol></li><li class="chapter-item expanded "><a href="../../../part1/intro/guessing-game/index.html"><strong aria-hidden="true">1.6.</strong> Walk-through: An LFE Guessing Game</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../part1/intro/guessing-game/planning.html"><strong aria-hidden="true">1.6.1.</strong> Planning the Game</a></li><li class="chapter-item "><a href="../../../part1/intro/guessing-game/code.html"><strong aria-hidden="true">1.6.2.</strong> Code Explore</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../part1/intro/guessing-game/input.html"><strong aria-hidden="true">1.6.2.1.</strong> Getting User Input</a></li><li class="chapter-item "><a href="../../../part1/intro/guessing-game/check.html"><strong aria-hidden="true">1.6.2.2.</strong> Checking the Input</a></li></ol></li><li class="chapter-item "><a href="../../../part1/intro/guessing-game/integrate.html"><strong aria-hidden="true">1.6.3.</strong> Integrating into an Application</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../part1/intro/guessing-game/cast.html"><strong aria-hidden="true">1.6.3.1.</strong> handle_cast</a></li><li class="chapter-item "><a href="../../../part1/intro/guessing-game/api.html"><strong aria-hidden="true">1.6.3.2.</strong> Game API</a></li><li class="chapter-item "><a href="../../../part1/intro/guessing-game/finishing-touches.html"><strong aria-hidden="true">1.6.3.3.</strong> Finishing Touches</a></li><li class="chapter-item "><a href="../../../part1/intro/guessing-game/play.html"><strong aria-hidden="true">1.6.3.4.</strong> Playing the Game</a></li></ol></li><li class="chapter-item expanded "><a href="../../../part1/intro/guessing-game/review.html" class="active"><strong aria-hidden="true">1.6.4.</strong> Code Review</a></li></ol></li><li class="chapter-item "><a href="../../../part1/repl/index.html"><strong aria-hidden="true">1.7.</strong> The LFE REPL</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../part1/repl/features.html"><strong aria-hidden="true">1.7.1.</strong> Core Features</a></li><li class="chapter-item "><a href="../../../part1/repl/start.html"><strong aria-hidden="true">1.7.2.</strong> Starting LFE</a></li><li class="chapter-item "><a href="../../../part1/repl/readline.html"><strong aria-hidden="true">1.7.3.</strong> readline Support</a></li><li class="chapter-item "><a href="../../../part1/repl/help.html"><strong aria-hidden="true">1.7.4.</strong> (help)</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../part1/repl/help-builtins.html"><strong aria-hidden="true">1.7.4.1.</strong> REPL Functions</a></li><li class="chapter-item "><a href="../../../part1/repl/help-cmds.html"><strong aria-hidden="true">1.7.4.2.</strong> REPL Commands</a></li><li class="chapter-item "><a href="../../../part1/repl/help-special-vars.html"><strong aria-hidden="true">1.7.4.3.</strong> Special Variables</a></li></ol></li><li class="chapter-item "><a href="../../../part1/repl/c.html"><strong aria-hidden="true">1.7.5.</strong> Command Interface</a></li><li class="chapter-item "><a href="../../../part1/repl/job-control.html"><strong aria-hidden="true">1.7.6.</strong> Job Control</a></li></ol></li></ol></li><li class="chapter-item "><strong aria-hidden="true">2.</strong> Part II - Code as Data<a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../part2/data-types/index.html"><strong aria-hidden="true">2.1.</strong> Primitive Types</a></li><li class="chapter-item "><a href="../../../part2/data-types/index.html"><strong aria-hidden="true">2.2.</strong> Conss</a></li><li class="chapter-item "><a href="../../../part2/lists/index.html"><strong aria-hidden="true">2.3.</strong> Lists and Strings</a></li><li class="chapter-item "><a href="../../../part2/byte-bin/index.html"><strong aria-hidden="true">2.4.</strong> Bytes and Binaries</a></li><li class="chapter-item "><a href="../../../part2/tuples/index.html"><strong aria-hidden="true">2.5.</strong> Tuples</a></li><li class="chapter-item "><a href="../../../part2/proplists/index.html"><strong aria-hidden="true">2.6.</strong> Property Lists</a></li><li class="chapter-item "><a href="../../../part2/maps/index.html"><strong aria-hidden="true">2.7.</strong> Maps</a></li><li class="chapter-item "><a href="../../../part2/patterns/index.html"><strong aria-hidden="true">2.8.</strong> Pattern Matching</a></li><li class="chapter-item "><a href="../../../part2/arrays/index.html"><strong aria-hidden="true">2.9.</strong> Arrays</a></li><li class="chapter-item "><a href="../../../part2/dicts/index.html"><strong aria-hidden="true">2.10.</strong> Dicts</a></li><li class="chapter-item "><a href="../../../part2/records/index.html"><strong aria-hidden="true">2.11.</strong> Records</a></li><li class="chapter-item "><a href="../../../part2/gen-seq/index.html"><strong aria-hidden="true">2.12.</strong> Generic Sequence Functions</a></li></ol></li><li class="chapter-item "><strong aria-hidden="true">3.</strong> Part III - Data as Code<a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../part3/exprs/index.html"><strong aria-hidden="true">3.1.</strong> Expressions</a></li><li class="chapter-item "><a href="../../../part3/funs/index.html"><strong aria-hidden="true">3.2.</strong> Functions</a></li><li class="chapter-item "><a href="../../../part3/closures/index.html"><strong aria-hidden="true">3.3.</strong> Closures</a></li><li class="chapter-item "><a href="../../../part3/eval/index.html"><strong aria-hidden="true">3.4.</strong> Evaluation</a></li><li class="chapter-item "><a href="../../../part3/expressioins/index.html"><strong aria-hidden="true">3.5.</strong> Expressions</a></li><li class="chapter-item "><a href="../../../part3/processes/index.html"><strong aria-hidden="true">3.6.</strong> Processes</a></li><li class="chapter-item "><a href="../../../part3/msgs/index.html"><strong aria-hidden="true">3.7.</strong> Messages and Their Passing</a></li><li class="chapter-item "><a href="../../../part3/objects/index.html"><strong aria-hidden="true">3.8.</strong> Objects and Flavors</a></li><li class="chapter-item "><a href="../../../part3/io/index.html"><strong aria-hidden="true">3.9.</strong> I/O</a></li><li class="chapter-item "><a href="../../../part3/files/index.html"><strong aria-hidden="true">3.10.</strong> Accessing Files</a></li><li class="chapter-item "><a href="../../../part3/modules/index.html"><strong aria-hidden="true">3.11.</strong> Modules</a></li><li class="chapter-item "><a href="../../../part3/packages/index.html"><strong aria-hidden="true">3.12.</strong> Packages</a></li><li class="chapter-item "><a href="../../../part3/scripting/index.html"><strong aria-hidden="true">3.13.</strong> Scripting with LFE</a></li></ol></li><li class="chapter-item "><strong aria-hidden="true">4.</strong> Part IV - Advanced Topics<a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../part4/err-debug/index.html"><strong aria-hidden="true">4.1.</strong> Errors and Debugging</a></li><li class="chapter-item "><a href="../../../part4/unit/index.html"><strong aria-hidden="true">4.2.</strong> Writing Unit Tests</a></li><li class="chapter-item "><a href="../../../part4/ct/index.html"><strong aria-hidden="true">4.3.</strong> The Common Test Framework</a></li><li class="chapter-item "><a href="../../../part4/propr/index.html"><strong aria-hidden="true">4.4.</strong> The Propr Test Framework</a></li><li class="chapter-item "><a href="../../../part4/compiler/index.html"><strong aria-hidden="true">4.5.</strong> The Compiler</a></li><li class="chapter-item "><a href="../../../part4/macros/index.html"><strong aria-hidden="true">4.6.</strong> Macros</a></li><li class="chapter-item "><a href="../../../part4/dist/index.html"><strong aria-hidden="true">4.7.</strong> Distributed LFE</a></li><li class="chapter-item "><a href="../../../part4/ports/REAEDME.html"><strong aria-hidden="true">4.8.</strong> Ports and Port Drivers</a></li><li class="chapter-item "><a href="../../../part4/servers/REAEDME.html"><strong aria-hidden="true">4.9.</strong> Servers</a></li><li class="chapter-item "><a href="../../../part4/clients/REAEDME.html"><strong aria-hidden="true">4.10.</strong> Clients</a></li></ol></li><li class="chapter-item "><strong aria-hidden="true">5.</strong> Part V - OTP<a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../part5/behaviours/index.html"><strong aria-hidden="true">5.1.</strong> Behaviours</a></li><li class="chapter-item "><a href="../../../part5/apps/index.html"><strong aria-hidden="true">5.2.</strong> Applications</a></li><li class="chapter-item "><a href="../../../part5/rels/index.html"><strong aria-hidden="true">5.3.</strong> Releases</a></li><li class="chapter-item "><a href="../../../part5/data/index.html"><strong aria-hidden="true">5.4.</strong> Tables and Databases</a></li><li class="chapter-item "><a href="../../../part5/project/index.html"><strong aria-hidden="true">5.5.</strong> Example OTP Project</a></li></ol></li><li class="chapter-item "><strong aria-hidden="true">6.</strong> Part VI - Conclusion<a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../part6/epilogue.html"><strong aria-hidden="true">6.1.</strong> Epilogue</a></li><li class="chapter-item "><a href="../../../part6/afterward.html"><strong aria-hidden="true">6.2.</strong> Afterword</a></li><li class="spacer"></li></ol></li><li class="chapter-item "><a href="../../../epilogue/glossary.html">Glossary</a></li><li class="chapter-item affix "><a href="../../../epilogue/bibliography.html">Bibliography</a></li><li class="chapter-item affix "><a href="../../../epilogue/index.html">Index</a></li><li class="spacer"></li><li class="chapter-item affix ">Appendices</li><li class="chapter-item affix "><a href="../../../appendices/lisp-history.html">I - Origins Of Lisp</a></li><li class="chapter-item affix "><a href="../../../appendices/erlang-history.html">II - Origins Of Erlang</a></li><li class="chapter-item affix "><a href="../../../appendices/lfe-overview.html">III - Origins Of LFE</a></li><li class="spacer"></li><li class="chapter-item affix "><a href="../../../versions.html">Versions</a></li><li class="chapter-item affix "><a href="../../../feedback.html">Feedback</a></li><li class="chapter-item affix "><a href="../../../redirects/docs.html">LFE Documentation</a></li><li class="chapter-item affix "><a href="../../../redirects/mdbook.html">Built with mdBook</a></li></ol>
        </div>
        <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
    </nav>

    <div id="page-wrapper" class="page-wrapper">

        <div class="page">
            
            <div id="menu-bar-hover-placeholder"></div>
            <div id="menu-bar" class="menu-bar sticky bordered">
                <div class="left-buttons">
                    <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents"
                        aria-label="Toggle Table of Contents" aria-controls="sidebar">
                        <i class="fa fa-bars"></i>
                    </button>
                    <button id="theme-toggle" class="icon-button" type="button" title="Change theme"
                        aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                        <i class="fa fa-paint-brush"></i>
                    </button>
                    <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                        <li role="none"><button role="menuitem" class="theme"
                                id="lfe-pdp">LFE PDP</button></li>
                        <li role="none"><button role="menuitem" class="theme"
                                id="light">Light</button></li>
                        <li role="none"><button role="menuitem" class="theme"
                                id="rust">Rust</button></li>
                        <li role="none"><button role="menuitem" class="theme"
                                id="coal">Coal</button></li>
                        <li role="none"><button role="menuitem" class="theme"
                                id="navy">Navy</button></li>
                        <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button>
                        </li>
                    </ul>
                    
                    <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)"
                        aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S"
                        aria-controls="searchbar">
                        <i class="fa fa-search"></i>
                    </button>
                    
                </div>

                <h1 class="menu-title">LFE MACHINE MANUAL</h1>

                <div class="right-buttons">
                    <a href="../../../print.html" title="Print this book" aria-label="Print this book">
                        <i id="print-button" class="fa fa-print"></i>
                    </a>
                    
                    <a href="https://github.com/cnbbooks/lfe-manual" title="Git repository" aria-label="Git repository">
                        <i id="git-repository-button" class="fa fa-github"></i>
                    </a>
                    
                </div>
            </div>

            
            <div id="search-wrapper" class="hidden">
                <form id="searchbar-outer" class="searchbar-outer">
                    <input type="search" name="search" id="searchbar" name="searchbar"
                        placeholder="Search this book ..." aria-controls="searchresults-outer"
                        aria-describedby="searchresults-header">
                </form>
                <div id="searchresults-outer" class="searchresults-outer hidden">
                    <div id="searchresults-header" class="searchresults-header"></div>
                    <ul id="searchresults">
                    </ul>
                </div>
            </div>
            

            <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
            <script type="text/javascript">
                document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                Array.from(document.querySelectorAll('#sidebar a')).forEach(function (link) {
                    link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                });
            </script>

            <div id="content" class="content">
                <main>
                    <h1><a class="header" href="#code-review" id="code-review">Code Review</a></h1>
<p>We've got the whole rest of the book ahead of us to cover much of what you've seen in the sample project we've just created with our guessing game. In the coming pages, you will revisit every aspect of what you've seen so far in lots of detail with correspondingly useful insttruction on these matters.</p>
<p>That being said, it would be unfair to not at least read through the code together and mention the high-level concepts involved. Since we only touched the code in one file, that will be the one that gets the most of our attention for this short review, but let's touch on the others here, too.</p>
<h2><a class="header" href="#project-files" id="project-files">Project Files</a></h2>
<h3><a class="header" href="#rebarconfig" id="rebarconfig"><code>rebar.config</code></a></h3>
<p>This is the file you need in every LFE project you will write in order to take advantage of the features (and time-savings!) that <code>rebar3</code> provides. For this project, the two important parts are:</p>
<ol>
<li>the entry for dependences (only LFE in this case), and</li>
<li>the plugins entry for the LFE rebar3 plugin.</li>
</ol>
<h2><a class="header" href="#source-files" id="source-files">Source Files</a></h2>
<h3><a class="header" href="#appsrc" id="appsrc"><code>.app.src</code></a></h3>
<p>This file is mostly used for application metadata. Most of what our app uses in this file is pretty self-explanatory. Every LFE application will have one of these in the project source code.</p>
<h3><a class="header" href="#guessing-game-applfe" id="guessing-game-applfe"><code>guessing-game-app.lfe</code></a></h3>
<p>This is the top-level file for our game, an OTP application. It only exports two functions: one to start the app and the other to stop it. The application is responsible for starting up whatever supervisors all your services/servers need. In the guess of this sample application, only one supervisor is needed (with a very simple supervision tree).</p>
<h3><a class="header" href="#guessing-game-suplfe" id="guessing-game-suplfe"><code>guessing-game-sup.lfe</code></a></h3>
<p>This module is a little more invloved and has all the configuration and code necessary to properly set up a supervisor for our server. When something goes wrong with our server, the restart strategy defined by our supervisor will kick in and get things back up and running again. This is one of the key secrets to OTP's wizardry, and we will be covering this in great detail later.</p>
<h3><a class="header" href="#srcguessing-gamelfe" id="srcguessing-gamelfe"><code>src/guessing-game.lfe</code></a></h3>
<p>This is the last file we'll look at, and is the one we'll cover in the most detail right now. Here's the entire content of what we created for our game:</p>
<pre><code class="language-lisp">(defmodule guessing-game
  (behaviour gen_server)
  (export
   ;; gen_server implementation
   (start_link 0)
   (stop 0)
   ;; callback implementation
   (init 1)
   (handle_call 3)
   (handle_cast 2)
   (handle_info 2)
   (terminate 2)
   (code_change 3)
   ;; server API
   (pid 0)
   (echo 1)
   (start-game 0)
   (stop-game 0)
   (guess 1)))

;;; ----------------
;;; config functions
;;; ----------------

(defun SERVER () (MODULE))
(defun initial-state () '#())
(defun genserver-opts () '())
(defun unknown-command () #(error &quot;Unknown command.&quot;))

;;; -------------------------
;;; gen_server implementation
;;; -------------------------

(defun start_link ()
  (gen_server:start_link `#(local ,(SERVER))
                         (MODULE)
                         (initial-state)
                         (genserver-opts)))

(defun stop ()
  (gen_server:call (SERVER) 'stop))

;;; -----------------------
;;; callback implementation
;;; -----------------------

(defun init (state)
  (random:seed (erlang:phash2 `(,(node)))
               (erlang:monotonic_time)
               (erlang:unique_integer))
  `#(ok ,state))

(defun handle_cast
  ((`#(start-game true) _state)
   (io:format &quot;Guess the number I have chosen, between 1 and 10.~n&quot;)
   `#(noreply ,(random:uniform 10)))
  ((`#(stop-game true) _state)
   (io:format &quot;Game over~n&quot;)
   '#(noreply undefined))
  ((`#(guess ,n) answer) (when (== n answer))
   (io:format &quot;Well-guessed!!~n&quot;)
   (stop-game)
   '#(noreply undefined))
  ((`#(guess ,n) answer) (when (&gt; n answer))
   (io:format &quot;Your guess is too high.~n&quot;)
   `#(noreply ,answer))
  ((`#(guess ,n) answer) (when (&lt; n answer))
   (io:format &quot;Your guess is too low.~n&quot;)
   `#(noreply ,answer))
  ((_msg state)
   `#(noreply ,state)))

(defun handle_call
  (('stop _from state)
   `#(stop shutdown ok state))
  ((`#(echo ,msg) _from state)
   `#(reply ,msg state))
  ((message _from state)
   `#(reply ,(unknown-command) ,state)))

(defun handle_info
  ((`#(EXIT ,_from normal) state)
   `#(noreply ,state))
  ((`#(EXIT ,pid ,reason) state)
   (io:format &quot;Process ~p exited! (Reason: ~p)~n&quot; `(,pid ,reason))
   `#(noreply ,state))
  ((_msg state)
   `#(noreply ,state)))

(defun terminate (_reason _state)
  'ok)

(defun code_change (_old-version state _extra)
  `#(ok ,state))

;;; --------------
;;; our server API
;;; --------------

(defun pid ()
  (erlang:whereis (SERVER)))

(defun echo (msg)
  (gen_server:call (SERVER) `#(echo ,msg)))

(defun start-game ()
  (gen_server:cast (SERVER) '#(start-game true)))

(defun stop-game ()
  (gen_server:cast (SERVER) '#(stop-game true)))

(defun guess (n)
  (gen_server:cast (SERVER) `#(guess ,n)))
</code></pre>
<p>The beginning of the file opens with a declaration of the module: not only its name, but the public functions we want to expose as part of our API. This will be covered in Chapter XXX, section XXX.</p>
<p>Next, we have a few constant functions. Functions are necessary here due to the fact that LFE does not have global variables. This will be covered in Chapter XXX, section XXX.</p>
<p>Then we define the functions that will be used as this module's implementation of a generic OTP server. There is some boilerplate here that will be discussed when we dive into LFE/OTP. This will be covered in Chapter XXX, section XXX.</p>
<p>After that, we define the functions that are used by the OTP machinery that will run our server. Here you see several examples of pattern matching function heads in LFE, a very powerful feature that lends itself nicely to consise and expressive code. This will be covered in Chapter XXX, section XXX.</p>
<p>Lastly, we define our own API. Most of these functions simply send messages to our running server. More on this in Chapter XXX, section XXX.</p>

                </main>

                <nav class="nav-wrapper" aria-label="Page navigation">
                    <!-- Mobile navigation buttons -->
                    
                    <a rel="prev" href="../../../part1/intro/guessing-game/play.html" class="mobile-nav-chapters previous"
                        title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    

                    
                    <a rel="next" href="../../../part1/repl/index.html" class="mobile-nav-chapters next"
                        title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                    

                    <div style="clear: both"></div>
                </nav>
            </div>
        </div>

        <nav class="nav-wide-wrapper" aria-label="Page navigation">
            
            <a rel="prev" href="../../../part1/intro/guessing-game/play.html" class="nav-chapters previous" title="Previous chapter"
                aria-label="Previous chapter" aria-keyshortcuts="Left">
                <i class="fa fa-angle-left"></i>
            </a>
            

            
            <a rel="next" href="../../../part1/repl/index.html" class="nav-chapters next" title="Next chapter"
                aria-label="Next chapter" aria-keyshortcuts="Right">
                <i class="fa fa-angle-right"></i>
            </a>
            
        </nav>

    </div>

    

    
    <!-- Google Analytics Tag -->
    <script type="text/javascript">
        var localAddrs = ["localhost", "127.0.0.1", ""];

        // make sure we don't activate google analytics if the developer is
        // inspecting the book locally...
        if (localAddrs.indexOf(document.location.hostname) === -1) {
            (function (i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date(); a = s.createElement(o),
                m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
            })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

            ga('create', 'UA-38274766-4', 'auto');
            ga('send', 'pageview');
        }
    </script>
    

    

    
    <script type="text/javascript">
        window.playground_copyable = true;
    </script>
    

    

    
    <script src="../../../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../../mark.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../../searcher.js" type="text/javascript" charset="utf-8"></script>
    

    <script src="../../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../../highlight.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../../book.js" type="text/javascript" charset="utf-8"></script>

    <!-- Custom JS scripts -->
    

    

</body>

</html>
